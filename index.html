<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>上海NEBS学生论坛</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        // Tailwind 配置
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366F1', // 主色调：靛蓝色
                        confession: '#EC4899', // 表白板块：粉色
                        complaint: '#EF4444',  // 吐槽板块：红色
                        question: '#3B82F6',   // 提问板块：蓝色
                        light: '#F8FAFC',
                        dark: '#1E293B'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1;
            }
            .btn-primary {
                @apply bg-primary text-white px-4 py-2 rounded-lg transition-all duration-300 hover:bg-primary/90 focus:ring-2 focus:ring-primary/50 focus:outline-none;
            }
            .btn-secondary {
                @apply bg-white text-primary border border-primary px-4 py-2 rounded-lg transition-all duration-300 hover:bg-primary/5 focus:ring-2 focus:ring-primary/50 focus:outline-none;
            }
            .section-indicator {
                @apply w-3 h-3 rounded-full inline-block mr-2;
            }
            .image-preview-container {
                @apply grid grid-cols-3 gap-3 mt-3;
            }
            .image-preview {
                @apply relative aspect-square bg-gray-100 rounded-md overflow-hidden;
            }
            .image-preview img {
                @apply w-full h-full object-cover;
            }
            .remove-image {
                @apply absolute top-1 right-1 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs cursor-pointer opacity-70 hover:opacity-100 transition-opacity;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-dark min-h-screen flex flex-col">
    <!-- 导航栏 -->
    <header id="navbar" class="bg-white shadow-sm fixed w-full z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="#" class="flex items-center space-x-2">
                <div class="bg-primary text-white p-2 rounded-lg">
                    <i class="fa fa-comments text-xl"></i>
                </div>
                <h1 class="text-xl font-bold text-primary">上海NEBS学生论坛</h1>
            </a>
            
            <!-- 桌面导航 -->
            <nav class="hidden md:flex items-center space-x-8">
                <a href="#home" class="font-medium hover:text-primary transition-colors">首页</a>
                <a href="#forum" class="font-medium hover:text-primary transition-colors">论坛板块</a>
                <a href="#submit" class="font-medium hover:text-primary transition-colors">发布内容</a>
                <div id="userMenu" class="flex items-center space-x-4">
                    <button id="loginBtn" class="btn-secondary hidden">登录</button>
                    <button id="registerBtn" class="btn-primary hidden">注册</button>
                    <div id="userDropdown" class="relative hidden">
                        <button id="userBtn" class="flex items-center space-x-2 focus:outline-none">
                            <img src="https://picsum.photos/id/64/40/40" alt="用户头像" class="w-8 h-8 rounded-full object-cover border-2 border-primary">
                            <span id="usernameDisplay" class="font-medium"></span>
                            <i class="fa fa-caret-down text-sm"></i>
                        </button>
                        <div id="dropdownMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-10 hidden">
                            <a href="#profile" class="block px-4 py-2 hover:bg-gray-100 transition-colors">个人资料</a>
                            <a href="#mySubmissions" class="block px-4 py-2 hover:bg-gray-100 transition-colors">我的发布</a>
                            <a href="#adminPanel" id="adminLink" class="block px-4 py-2 hover:bg-gray-100 transition-colors hidden">审核管理</a>
                            <div class="border-t border-gray-200 my-1"></div>
                            <a href="#" id="logoutBtn" class="block px-4 py-2 hover:bg-gray-100 transition-colors text-red-500">退出登录</a>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- 移动端菜单按钮 -->
            <button id="mobileMenuBtn" class="md:hidden text-dark focus:outline-none">
                <i class="fa fa-bars text-xl"></i>
            </button>
        </div>
        
        <!-- 移动端导航菜单 -->
        <div id="mobileMenu" class="md:hidden bg-white shadow-md absolute w-full left-0 top-full py-4 px-6 hidden">
            <nav class="flex flex-col space-y-4">
                <a href="#home" class="font-medium hover:text-primary transition-colors py-2">首页</a>
                <a href="#forum" class="font-medium hover:text-primary transition-colors py-2">论坛板块</a>
                <a href="#submit" class="font-medium hover:text-primary transition-colors py-2">发布内容</a>
                <div class="flex flex-col space-y-3 pt-2 border-t border-gray-100">
                    <button id="mobileLoginBtn" class="btn-secondary">登录</button>
                    <button id="mobileRegisterBtn" class="btn-primary">注册</button>
                    <div id="mobileUserMenu" class="hidden">
                        <div class="flex items-center space-x-3 mb-3">
                            <img src="https://picsum.photos/id/64/40/40" alt="用户头像" class="w-10 h-10 rounded-full object-cover border-2 border-primary">
                            <span id="mobileUsername" class="font-medium"></span>
                        </div>
                        <a href="#profile" class="block py-2 hover:text-primary transition-colors">个人资料</a>
                        <a href="#mySubmissions" class="block py-2 hover:text-primary transition-colors">我的发布</a>
                        <a href="#adminPanel" id="mobileAdminLink" class="block py-2 hover:text-primary transition-colors hidden">审核管理</a>
                        <a href="#" id="mobileLogoutBtn" class="block py-2 text-red-500 hover:text-red-600 transition-colors">退出登录</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="flex-grow pt-16">
        <!-- 首页英雄区 -->
        <section id="home" class="bg-gradient-to-br from-primary/90 to-primary py-20 md:py-32">
            <div class="container mx-auto px-4 text-center text-white">
                <h2 class="text-[clamp(2rem,5vw,3.5rem)] font-bold mb-6 text-shadow leading-tight">
                    上海NEBS学生论坛
                </h2>
                <p class="text-[clamp(1rem,2vw,1.25rem)] max-w-2xl mx-auto mb-10 text-white/90">
                    属于NEBS学生的交流空间，在这里可以自由表达，分享校园生活的点滴
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <a href="#submit" class="bg-white text-primary px-8 py-3 rounded-lg font-semibold transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                        发布内容
                    </a>
                    <a href="#forum" class="bg-transparent border-2 border-white text-white px-8 py-3 rounded-lg font-semibold transition-all duration-300 hover:bg-white/10 hover:-translate-y-1">
                        浏览论坛
                    </a>
                </div>
            </div>
        </section>

        <!-- 板块介绍 -->
        <section class="py-16 bg-white">
            <div class="container mx-auto px-4">
                <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-center mb-16">论坛板块</h2>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="bg-light rounded-xl p-8 text-center card-hover border-t-4 border-confession">
                        <div class="w-16 h-16 bg-confession/10 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fa fa-heart text-confession text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4 flex items-center justify-center">
                            <span class="section-indicator bg-confession"></span>表白墙
                        </h3>
                        <p class="text-neutral">
                            勇敢表达你的心意，向心仪的TA传递真挚情感，支持匿名发布
                        </p>
                        <a href="#forum" class="mt-6 inline-block text-confession hover:underline font-medium">
                            进入板块 <i class="fa fa-arrow-right ml-1"></i>
                        </a>
                    </div>
                    
                    <div class="bg-light rounded-xl p-8 text-center card-hover border-t-4 border-complaint">
                        <div class="w-16 h-16 bg-complaint/10 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fa fa-bullhorn text-complaint text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4 flex items-center justify-center">
                            <span class="section-indicator bg-complaint"></span>吐槽区
                        </h3>
                        <p class="text-neutral">
                            分享你的小烦恼，释放压力，但请保持文明用语，理性表达
                        </p>
                        <a href="#forum" class="mt-6 inline-block text-complaint hover:underline font-medium">
                            进入板块 <i class="fa fa-arrow-right ml-1"></i>
                        </a>
                    </div>
                    
                    <div class="bg-light rounded-xl p-8 text-center card-hover border-t-4 border-question">
                        <div class="w-16 h-16 bg-question/10 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fa fa-question-circle text-question text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4 flex items-center justify-center">
                            <span class="section-indicator bg-question"></span>提问区
                        </h3>
                        <p class="text-neutral">
                            关于学习、活动或校园生活的疑问，在这里寻找答案和建议
                        </p>
                        <a href="#forum" class="mt-6 inline-block text-question hover:underline font-medium">
                            进入板块 <i class="fa fa-arrow-right ml-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- 论坛区域 -->
        <section id="forum" class="py-16 bg-gray-50">
            <div class="container mx-auto px-4">
                <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-8 text-center">论坛内容</h2>
                
                <!-- 板块切换 -->
                <div class="flex flex-wrap justify-center gap-4 mb-10">
                    <button id="allPostsBtn" class="px-6 py-2 rounded-full bg-primary text-white text-sm flex items-center">
                        <i class="fa fa-th-large mr-2"></i> 全部内容
                    </button>
                    <button id="confessionBtn" class="px-6 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm flex items-center hover:border-confession hover:text-confession transition-colors">
                        <span class="section-indicator bg-confession"></span> 表白墙
                    </button>
                    <button id="complaintBtn" class="px-6 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm flex items-center hover:border-complaint hover:text-complaint transition-colors">
                        <span class="section-indicator bg-complaint"></span> 吐槽区
                    </button>
                    <button id="questionBtn" class="px-6 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm flex items-center hover:border-question hover:text-question transition-colors">
                        <span class="section-indicator bg-question"></span> 提问区
                    </button>
                </div>

                <div id="postsContainer" class="space-y-6">
                    <!-- 帖子会通过JavaScript动态生成 -->
                    <!-- 加载状态 -->
                    <div id="loadingPosts" class="py-10 text-center">
                        <i class="fa fa-spinner fa-spin text-primary text-2xl"></i>
                        <p class="mt-3 text-neutral">加载内容中...</p>
                    </div>
                    
                    <!-- 空状态 -->
                    <div id="noPosts" class="hidden py-20 text-center">
                        <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fa fa-file-text-o text-3xl text-gray-400"></i>
                        </div>
                        <h3 class="text-xl font-medium mb-2">暂无内容</h3>
                        <p class="text-neutral mb-6">目前还没有发布的内容，成为第一个分享的人吧！</p>
                        <a href="#submit" class="btn-primary inline-flex items-center">
                            <i class="fa fa-pencil mr-2"></i> 发布第一条内容
                        </a>
                    </div>
                </div>

                <div class="mt-10 text-center">
                    <button id="loadMoreBtn" class="btn-secondary inline-flex items-center">
                        <i class="fa fa-refresh mr-2"></i> 加载更多
                    </button>
                </div>
            </div>
        </section>

        <!-- 投稿区域 -->
        <section id="submit" class="py-16 bg-white">
            <div class="container mx-auto px-4 max-w-3xl">
                <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-8 text-center">发布内容</h2>
                
                <div id="loginPrompt" class="bg-blue-50 border border-blue-100 rounded-xl p-6 text-center mb-8">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-user-circle text-blue-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-medium mb-2">请先登录</h3>
                    <p class="text-blue-700 mb-6">登录后才能发布内容，所有内容将经过审核后发布</p>
                    <button id="submitLoginBtn" class="btn-primary">立即登录</button>
                </div>

                <form id="submissionForm" class="hidden bg-light rounded-xl p-6 md:p-8 shadow-sm">
                    <div class="mb-6">
                        <label for="submissionTitle" class="block text-sm font-medium mb-2">标题</label>
                        <input type="text" id="submissionTitle" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors" placeholder="请输入标题" required>
                    </div>
                    
                    <div class="mb-6">
                        <label for="submissionCategory" class="block text-sm font-medium mb-2">板块</label>
                        <select id="submissionCategory" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors">
                            <option value="confession">表白墙</option>
                            <option value="complaint">吐槽区</option>
                            <option value="question">提问区</option>
                        </select>
                    </div>
                    
                    <div class="mb-6">
                        <label for="submissionContent" class="block text-sm font-medium mb-2">内容</label>
                        <textarea id="submissionContent" rows="6" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors resize-none" placeholder="请输入你想分享的内容..." required></textarea>
                    </div>
                    
                    <!-- 图片上传区域 -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">上传图片（可选）</label>
                        <div class="flex items-center justify-center w-full">
                            <label for="imageUpload" class="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors">
                                <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                    <i class="fa fa-cloud-upload text-2xl text-gray-400 mb-2"></i>
                                    <p class="mb-1 text-sm text-gray-500"><span class="font-semibold">点击上传</span> 或拖放图片</p>
                                    <p class="text-xs text-gray-500">支持 JPG, PNG, GIF (最大 5MB)</p>
                                </div>
                                <input id="imageUpload" type="file" class="hidden" accept="image/*" multiple />
                            </label>
                        </div>
                        
                        <!-- 图片预览区域 -->
                        <div id="imagePreviewContainer" class="image-preview-container"></div>
                    </div>
                    
                    <div class="mb-8">
                        <label class="flex items-center">
                            <input type="checkbox" id="anonymousRequest" class="w-5 h-5 text-primary focus:ring-primary/50 border-gray-300 rounded">
                            <span class="ml-2 text-sm">申请匿名发布（管理员将根据此选项决定是否匿名）</span>
                        </label>
                    </div>
                    
                    <div class="flex justify-end">
                        <button type="submit" class="btn-primary inline-flex items-center">
                            <i class="fa fa-paper-plane mr-2"></i> 提交发布
                        </button>
                    </div>
                </form>

                <!-- 投稿成功提示 -->
                <div id="submissionSuccess" class="hidden bg-green-50 border border-green-100 rounded-xl p-6 text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-check text-green-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-medium mb-2">发布成功！</h3>
                    <p class="text-green-700 mb-6">你的内容已提交，将在审核通过后发布</p>
                    <button id="submitAnotherBtn" class="btn-secondary">再发布一条</button>
                </div>
            </div>
        </section>

        <!-- 我的发布 -->
        <section id="mySubmissions" class="py-16 bg-gray-50 hidden">
            <div class="container mx-auto px-4 max-w-4xl">
                <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-8 text-center">我的发布</h2>
                
                <div id="submissionsLoginPrompt" class="bg-blue-50 border border-blue-100 rounded-xl p-6 text-center mb-8">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-user-circle text-blue-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-medium mb-2">请先登录</h3>
                    <p class="text-blue-700 mb-6">登录后查看你的发布记录和状态</p>
                    <button id="submissionsLoginBtn" class="btn-primary">立即登录</button>
                </div>

                <div id="mySubmissionsContainer" class="space-y-6 hidden">
                    <!-- 发布记录会通过JavaScript动态生成 -->
                    <div id="noSubmissions" class="py-20 text-center">
                        <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fa fa-pencil text-3xl text-gray-400"></i>
                        </div>
                        <h3 class="text-xl font-medium mb-2">暂无发布</h3>
                        <p class="text-neutral mb-6">你还没有任何发布记录，快去分享你的想法吧！</p>
                        <a href="#submit" class="btn-primary inline-flex items-center">
                            <i class="fa fa-pencil mr-2"></i> 立即发布
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- 审核管理面板 -->
        <section id="adminPanel" class="py-16 bg-gray-50 hidden">
            <div class="container mx-auto px-4 max-w-4xl">
                <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-8 text-center">审核管理</h2>
                
                <div id="adminLoginPrompt" class="bg-blue-50 border border-blue-100 rounded-xl p-6 text-center mb-8">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-lock text-blue-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-medium mb-2">请先登录管理员账号</h3>
                    <p class="text-blue-700 mb-6">只有管理员可以访问审核管理面板</p>
                    <button id="adminLoginBtn" class="btn-primary">管理员登录</button>
                </div>

                <div id="adminPanelContainer" class="hidden">
                    <div class="flex flex-wrap gap-3 mb-8">
                        <button id="pendingReviewsBtn" class="px-4 py-2 rounded-full bg-primary text-white text-sm">待审核</button>
                        <button id="approvedBtn" class="px-4 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm hover:border-primary hover:text-primary transition-colors">已通过</button>
                        <button id="rejectedBtn" class="px-4 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm hover:border-primary hover:text-primary transition-colors">已拒绝</button>
                    </div>

                    <div id="pendingSubmissions" class="space-y-6">
                        <!-- 待审核内容会通过JavaScript动态生成 -->
                        <div id="noPendingSubmissions" class="py-20 text-center">
                            <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fa fa-check-circle text-3xl text-gray-400"></i>
                            </div>
                            <h3 class="text-xl font-medium mb-2">暂无待审核内容</h3>
                            <p class="text-neutral">所有内容都已审核完毕</p>
                        </div>
                    </div>

                    <div id="approvedSubmissions" class="space-y-6 hidden">
                        <!-- 已通过内容会通过JavaScript动态生成 -->
                    </div>

                    <div id="rejectedSubmissions" class="space-y-6 hidden">
                        <!-- 已拒绝内容会通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
        </section>

        <!-- 个人资料 -->
        <section id="profile" class="py-16 bg-white hidden">
            <div class="container mx-auto px-4 max-w-2xl">
                <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-8 text-center">个人资料</h2>
                
                <div id="profileLoginPrompt" class="bg-blue-50 border border-blue-100 rounded-xl p-6 text-center mb-8">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-user-circle text-blue-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-medium mb-2">请先登录</h3>
                    <p class="text-blue-700 mb-6">登录后查看和编辑你的个人资料</p>
                    <button id="profileLoginBtn" class="btn-primary">立即登录</button>
                </div>

                <div id="profileContainer" class="hidden">
                    <div class="text-center mb-10">
                        <img id="profileAvatar" src="https://picsum.photos/id/64/100/100" alt="用户头像" class="w-24 h-24 rounded-full object-cover border-4 border-primary mx-auto mb-4">
                        <h3 id="profileUsername" class="text-2xl font-bold mb-2"></h3>
                        <p id="profileJoinDate" class="text-neutral"></p>
                        <p id="profileRole" class="text-sm mt-2 hidden"></p>
                    </div>

                    <form id="profileForm" class="bg-light rounded-xl p-6 md:p-8 shadow-sm">
                        <div class="mb-6">
                            <label for="profileName" class="block text-sm font-medium mb-2">昵称</label>
                            <input type="text" id="profileName" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors">
                        </div>
                        
                        <div class="mb-6">
                            <label for="profilePhone" class="block text-sm font-medium mb-2">手机号</label>
                            <input type="tel" id="profilePhone" class="w-full px-4 py-3 rounded-lg border border-gray-300 bg-gray-100 cursor-not-allowed" disabled>
                        </div>
                        
                        <div class="mb-8">
                            <label for="profileBio" class="block text-sm font-medium mb-2">个人简介</label>
                            <textarea id="profileBio" rows="4" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors resize-none"></textarea>
                        </div>
                        
                        <div class="flex justify-end">
                            <button type="submit" class="btn-primary inline-flex items-center">
                                <i class="fa fa-save mr-2"></i> 保存修改
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div>
                    <div class="flex items-center space-x-2 mb-6">
                        <div class="bg-white text-primary p-2 rounded-lg">
                            <i class="fa fa-comments text-xl"></i>
                        </div>
                        <h3 class="text-xl font-bold">上海NEBS学生论坛</h3>
                    </div>
                    <p class="text-gray-400 mb-6">为上海NEBS学校学生提供一个安全、健康的交流平台，让每一个声音都能被听见。</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fa fa-weixin text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fa fa-weibo text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fa fa-qq text-xl"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-6">快速链接</h4>
                    <ul class="space-y-3">
                        <li><a href="#home" class="text-gray-400 hover:text-white transition-colors">首页</a></li>
                        <li><a href="#forum" class="text-gray-400 hover:text-white transition-colors">论坛板块</a></li>
                        <li><a href="#submit" class="text-gray-400 hover:text-white transition-colors">发布内容</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">使用须知</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 pt-8 text-center text-gray-500 text-sm">
                <p>© 2023 上海NEBS学生论坛 版权所有</p>
            </div>
        </div>
    </footer>

    <!-- 登录模态框 -->
    <div id="loginModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6 md:p-8 transform transition-all scale-95 opacity-0" id="modalContent">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">用户登录</h3>
                <button id="closeLoginModal" class="text-gray-400 hover:text-dark focus:outline-none">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="loginForm">
                <div class="mb-6">
                    <label for="loginPhone" class="block text-sm font-medium mb-2">手机号</label>
                    <input type="tel" id="loginPhone" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors" placeholder="请输入手机号" required>
                </div>
                
                <div class="mb-6">
                    <label for="loginPassword" class="block text-sm font-medium mb-2">密码</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors" placeholder="请输入密码" required>
                </div>
                
                <div class="flex items-center justify-between mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" class="w-5 h-5 text-primary focus:ring-primary/50 border-gray-300 rounded">
                        <span class="ml-2 text-sm">记住我</span>
                    </label>
                    <a href="#" class="text-sm text-primary hover:underline">忘记密码？</a>
                </div>
                
                <button type="submit" class="w-full btn-primary">登录</button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-sm">还没有账号？ <button id="switchToRegister" class="text-primary hover:underline">立即注册</button></p>
            </div>
        </div>
    </div>

    <!-- 注册模态框 -->
    <div id="registerModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6 md:p-8 transform transition-all scale-95 opacity-0" id="registerModalContent">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">用户注册</h3>
                <button id="closeRegisterModal" class="text-gray-400 hover:text-dark focus:outline-none">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="registerForm">
                <div class="mb-6">
                    <label for="registerPhone" class="block text-sm font-medium mb-2">手机号</label>
                    <input type="tel" id="registerPhone" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors" placeholder="请输入手机号" required>
                </div>
                
                <div class="mb-6">
                    <label for="registerName" class="block text-sm font-medium mb-2">昵称</label>
                    <input type="text" id="registerName" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors" placeholder="请设置昵称" required>
                </div>
                
                <div class="mb-6">
                    <label for="registerPassword" class="block text-sm font-medium mb-2">密码</label>
                    <input type="password" id="registerPassword" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors" placeholder="请设置密码（至少6位）" required minlength="6">
                </div>
                
                <div class="mb-6">
                    <label for="registerConfirmPassword" class="block text-sm font-medium mb-2">确认密码</label>
                    <input type="password" id="registerConfirmPassword" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors" placeholder="请再次输入密码" required>
                </div>
                
                <div class="mb-6">
                    <label class="flex items-start">
                        <input type="checkbox" class="w-5 h-5 text-primary focus:ring-primary/50 border-gray-300 rounded mt-1" required>
                        <span class="ml-2 text-sm">我已阅读并同意<a href="#" class="text-primary hover:underline">用户协议</a>和<a href="#" class="text-primary hover:underline">隐私政策</a></span>
                    </label>
                </div>
                
                <button type="submit" class="w-full btn-primary">注册</button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-sm">已有账号？ <button id="switchToLogin" class="text-primary hover:underline">立即登录</button></p>
            </div>
        </div>
    </div>

    <!-- 审核模态框 -->
    <div id="reviewModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-3xl p-6 md:p-8 transform transition-all scale-95 opacity-0 max-h-[90vh] overflow-y-auto" id="reviewModalContent">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">审核内容</h3>
                <button id="closeReviewModal" class="text-gray-400 hover:text-dark focus:outline-none">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="reviewContent" class="mb-6">
                <h4 id="reviewTitle" class="text-lg font-semibold mb-2"></h4>
                <p id="reviewCategory" class="text-sm text-neutral mb-4"></p>
                <div id="reviewImages" class="image-preview-container mb-4"></div>
                <div id="reviewBody" class="bg-light p-4 rounded-lg mb-4"></div>
                <div class="flex flex-wrap gap-4 text-sm">
                    <span>发布人: <span id="reviewAuthor" class="font-medium"></span></span>
                    <span>发布人手机号: <span id="reviewAuthorPhone" class="font-medium"></span></span>
                    <span>发布时间: <span id="reviewTime"></span></span>
                </div>
            </div>
            
            <div class="mb-6">
                <label for="reviewNote" class="block text-sm font-medium mb-2">审核备注（可选）</label>
                <textarea id="reviewNote" rows="3" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-colors resize-none" placeholder="请输入审核备注（将通知给发布人）"></textarea>
            </div>
            
            <div class="mb-6">
                <label class="flex items-center">
                    <input type="checkbox" id="reviewAnonymous" class="w-5 h-5 text-primary focus:ring-primary/50 border-gray-300 rounded">
                    <span class="ml-2 text-sm">允许匿名发布</span>
                </label>
            </div>
            
            <div class="flex justify-end gap-4">
                <button id="rejectSubmission" class="px-6 py-2 bg-white text-red-500 border border-red-500 rounded-lg transition-all duration-300 hover:bg-red-50 focus:outline-none">
                    拒绝
                </button>
                <button id="approveSubmission" class="px-6 py-2 bg-green-500 text-white rounded-lg transition-all duration-300 hover:bg-green-600 focus:outline-none">
                    通过并发布
                </button>
            </div>
        </div>
    </div>

    <!-- 通知提示 -->
    <div id="notification" class="fixed bottom-6 right-6 bg-dark text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center z-50">
        <i id="notificationIcon" class="fa fa-check-circle mr-3 text-green-400"></i>
        <span id="notificationMessage"></span>
    </div>

    <script>
        // 数据模型
        const AppData = {
            // 管理员手机号
            adminPhone: '13262666668',
            
            // 当前登录用户
            currentUser: null,
            
            // 用户列表
            users: [],
            
            // 投稿状态
            submissionStatus: {
                PENDING: 'pending',
                APPROVED: 'approved',
                REJECTED: 'rejected'
            },
            
            // 板块配置
            categories: {
                'confession': {
                    name: '表白墙',
                    color: 'confession'
                },
                'complaint': {
                    name: '吐槽区',
                    color: 'complaint'
                },
                'question': {
                    name: '提问区',
                    color: 'question'
                }
            },
            
            // 投稿列表（初始为空）
            submissions: [],
            
            // 从本地存储加载数据
            loadFromLocalStorage() {
                const savedUsers = localStorage.getItem('nebs_users');
                const savedSubmissions = localStorage.getItem('nebs_submissions');
                const savedCurrentUser = localStorage.getItem('nebs_currentUser');
                
                if (savedUsers) this.users = JSON.parse(savedUsers);
                if (savedSubmissions) this.submissions = JSON.parse(savedSubmissions);
                if (savedCurrentUser) this.currentUser = JSON.parse(savedCurrentUser);
            },
            
            // 保存数据到本地存储
            saveToLocalStorage() {
                localStorage.setItem('nebs_users', JSON.stringify(this.users));
                localStorage.setItem('nebs_submissions', JSON.stringify(this.submissions));
                localStorage.setItem('nebs_currentUser', JSON.stringify(this.currentUser));
            },
            
            // 用户登录（使用手机号）
            login(phone, password) {
                // 查找用户
                const user = this.users.find(u => u.phone === phone && u.password === password);
                if (user) {
                    // 检查是否为管理员
                    user.isAdmin = phone === this.adminPhone;
                    
                    this.currentUser = user;
                    this.saveToLocalStorage();
                    return { success: true, user };
                }
                
                return { success: false, message: '手机号或密码错误' };
            },
            
            // 用户注册（使用手机号）
            register(userData) {
                // 检查手机号是否已存在
                if (this.users.some(u => u.phone === userData.phone)) {
                    return { success: false, message: '手机号已被注册' };
                }
                
                // 检查是否是管理员手机号注册
                const isAdmin = userData.phone === this.adminPhone;
                
                // 创建新用户
                const newUser = {
                    id: `user${this.users.length + 1}`,
                    phone: userData.phone,
                    name: userData.name,
                    password: userData.password,
                    bio: '',
                    avatar: `https://picsum.photos/id/${200 + this.users.length}/100/100`,
                    joinDate: new Date().toISOString().split('T')[0],
                    isAdmin: isAdmin
                };
                
                this.users.push(newUser);
                this.currentUser = newUser;
                this.saveToLocalStorage();
                
                return { success: true, user: newUser };
            },
            
            // 用户登出
            logout() {
                this.currentUser = null;
                this.saveToLocalStorage();
            },
            
            // 提交新投稿
            submitSubmission(submissionData) {
                if (!this.currentUser) {
                    return { success: false, message: '请先登录' };
                }
                
                const newSubmission = {
                    id: `sub${this.submissions.length + 1}`,
                    title: submissionData.title,
                    category: submissionData.category,
                    content: submissionData.content,
                    images: submissionData.images || [], // 存储图片的base64编码
                    authorId: this.currentUser.id,
                    authorName: this.currentUser.name,
                    authorPhone: this.currentUser.phone,
                    anonymousRequest: submissionData.anonymousRequest,
                    anonymous: false, // 默认不匿名，由管理员决定
                    status: this.submissionStatus.PENDING,
                    submitTime: new Date().toISOString(),
                    reviewTime: null,
                    reviewNote: ''
                };
                
                this.submissions.unshift(newSubmission); // 添加到最前面
                this.saveToLocalStorage();
                
                return { success: true, submission: newSubmission };
            },
            
            // 获取分类名称
            getCategoryName(category) {
                return this.categories[category]?.name || '其他';
            },
            
            // 获取分类颜色
            getCategoryColor(category) {
                return this.categories[category]?.color || 'primary';
            },
            
            // 审核投稿
            reviewSubmission(submissionId, approve, anonymous, note) {
                const submission = this.submissions.find(s => s.id === submissionId);
                if (!submission) {
                    return { success: false, message: '内容不存在' };
                }
                
                submission.status = approve ? this.submissionStatus.APPROVED : this.submissionStatus.REJECTED;
                submission.anonymous = anonymous;
                submission.reviewNote = note;
                submission.reviewTime = new Date().toISOString();
                
                this.saveToLocalStorage();
                return { success: true, submission };
            },
            
            // 更新用户资料
            updateProfile(profileData) {
                if (!this.currentUser) {
                    return { success: false, message: '请先登录' };
                }
                
                const userIndex = this.users.findIndex(u => u.id === this.currentUser.id);
                if (userIndex !== -1) {
                    this.users[userIndex].name = profileData.name || this.users[userIndex].name;
                    this.users[userIndex].bio = profileData.bio || this.users[userIndex].bio;
                    
                    // 更新当前用户信息
                    this.currentUser = { ...this.currentUser, ...this.users[userIndex] };
                    this.saveToLocalStorage();
                    
                    return { success: true, user: this.currentUser };
                }
                
                return { success: false, message: '用户不存在' };
            },
            
            // 获取用户的投稿
            getUserSubmissions(userId) {
                return this.submissions.filter(s => s.authorId === userId);
            },
            
            // 获取待审核的投稿
            getPendingSubmissions() {
                return this.submissions.filter(s => s.status === this.submissionStatus.PENDING);
            },
            
            // 获取已通过的投稿
            getApprovedSubmissions() {
                return this.submissions.filter(s => s.status === this.submissionStatus.APPROVED);
            },
            
            // 获取已拒绝的投稿
            getRejectedSubmissions() {
                return this.submissions.filter(s => s.status === this.submissionStatus.REJECTED);
            }
        };

        // 工具函数
        const Utils = {
            // 格式化日期
            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            },
            
            // 格式化手机号（中间四位隐藏）
            formatPhone(phone) {
                if (!phone) return '';
                return phone.replace(/(\d{3})(\d{4})(\d{4})/, '$1****$3');
            },
            
            // 显示通知
            showNotification(message, isError = false) {
                const notification = document.getElementById('notification');
                const notificationIcon = document.getElementById('notificationIcon');
                const notificationMessage = document.getElementById('notificationMessage');
                
                notificationMessage.textContent = message;
                
                if (isError) {
                    notificationIcon.className = 'fa fa-exclamation-circle mr-3 text-red-400';
                } else {
                    notificationIcon.className = 'fa fa-check-circle mr-3 text-green-400';
                }
                
                notification.classList.remove('translate-y-20', 'opacity-0');
                notification.classList.add('translate-y-0', 'opacity-100');
                
                setTimeout(() => {
                    notification.classList.remove('translate-y-0', 'opacity-100');
                    notification.classList.add('translate-y-20', 'opacity-0');
                }, 3000);
            },
            
            // 显示模态框
            showModal(modalId) {
                const modal = document.getElementById(modalId);
                const modalContent = document.getElementById(modalId === 'loginModal' ? 'modalContent' : 
                                    modalId === 'registerModal' ? 'registerModalContent' : 'reviewModalContent');
                
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modalContent.classList.remove('scale-95', 'opacity-0');
                    modalContent.classList.add('scale-100', 'opacity-100');
                }, 10);
                
                // 阻止背景滚动
                document.body.style.overflow = 'hidden';
            },
            
            // 隐藏模态框
            hideModal(modalId) {
                const modal = document.getElementById(modalId);
                const modalContent = document.getElementById(modalId === 'loginModal' ? 'modalContent' : 
                                    modalId === 'registerModal' ? 'registerModalContent' : 'reviewModalContent');
                
                modalContent.classList.remove('scale-100', 'opacity-100');
                modalContent.classList.add('scale-95', 'opacity-0');
                
                setTimeout(() => {
                    modal.classList.add('hidden');
                    // 恢复背景滚动
                    document.body.style.overflow = '';
                }, 300);
            },
            
            // 清空表单
            clearForm(formId) {
                const form = document.getElementById(formId);
                if (form) {
                    form.reset();
                }
            },
            
            // 平滑滚动到锚点
            scrollToAnchor(anchorId) {
                const element = document.getElementById(anchorId);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth' });
                    
                    // 关闭移动菜单
                    document.getElementById('mobileMenu').classList.add('hidden');
                }
            },
            
            // 图片转Base64
            imageToBase64(file, callback) {
                const reader = new FileReader();
                reader.onloadend = function() {
                    callback(reader.result);
                };
                reader.readAsDataURL(file);
            },
            
            // 限制图片大小
            isImageSizeValid(file, maxSizeMB = 5) {
                const maxSizeBytes = maxSizeMB * 1024 * 1024;
                return file.size <= maxSizeBytes;
            },
            
            // 检查图片类型
            isImageTypeValid(file) {
                const validTypes = ['image/jpeg', 'image/png', 'image/gif'];
                return validTypes.includes(file.type);
            }
        };

        // 视图控制器
        const ViewController = {
            // 初始化页面
            init() {
                // 从本地存储加载数据
                AppData.loadFromLocalStorage();
                
                // 初始化导航栏滚动效果
                this.initNavbarScroll();
                
                // 初始化事件监听
                this.initEventListeners();
                
                // 初始化图片上传功能
                this.initImageUpload();
                
                // 更新页面状态
                this.updatePageState();
                
                // 加载帖子
                this.loadPosts();
            },
            
            // 初始化导航栏滚动效果
            initNavbarScroll() {
                const navbar = document.getElementById('navbar');
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 50) {
                        navbar.classList.add('py-2', 'shadow');
                        navbar.classList.remove('py-3');
                    } else {
                        navbar.classList.add('py-3');
                        navbar.classList.remove('py-2', 'shadow');
                    }
                });
            },
            
            // 初始化图片上传功能
            initImageUpload() {
                const imageUpload = document.getElementById('imageUpload');
                const previewContainer = document.getElementById('imagePreviewContainer');
                const submissionForm = document.getElementById('submissionForm');
                
                // 存储上传的图片
                let uploadedImages = [];
                
                // 监听文件上传
                imageUpload.addEventListener('change', (e) => {
                    const files = e.target.files;
                    if (!files || files.length === 0) return;
                    
                    // 处理每个文件
                    Array.from(files).forEach(file => {
                        // 验证图片类型
                        if (!Utils.isImageTypeValid(file)) {
                            Utils.showNotification('请上传JPG、PNG或GIF格式的图片', true);
                            return;
                        }
                        
                        // 验证图片大小
                        if (!Utils.isImageSizeValid(file)) {
                            Utils.showNotification('图片大小不能超过5MB', true);
                            return;
                        }
                        
                        // 转换为base64并显示预览
                        Utils.imageToBase64(file, (base64) => {
                            uploadedImages.push(base64);
                            this.addImagePreview(previewContainer, base64, uploadedImages.length - 1, (index) => {
                                // 移除图片
                                uploadedImages.splice(index, 1);
                            });
                        });
                    });
                    
                    // 清空input值，允许重复选择同一文件
                    imageUpload.value = '';
                });
                
                // 处理拖放功能
                const dropArea = imageUpload.parentElement;
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, this.preventDefaults, false);
                });
                
                function highlight() {
                    dropArea.classList.add('border-primary');
                }
                
                function unhighlight() {
                    dropArea.classList.remove('border-primary');
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropArea.addEventListener(eventName, highlight, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, unhighlight, false);
                });
                
                dropArea.addEventListener('drop', (e) => {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    
                    if (files && files.length > 0) {
                        imageUpload.files = files;
                        // 触发change事件
                        const event = new Event('change');
                        imageUpload.dispatchEvent(event);
                    }
                }, false);
                
                // 表单提交时处理图片
                submissionForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    
                    const title = document.getElementById('submissionTitle').value;
                    const category = document.getElementById('submissionCategory').value;
                    const content = document.getElementById('submissionContent').value;
                    const anonymousRequest = document.getElementById('anonymousRequest').checked;
                    
                    // 包含图片数据
                    const result = AppData.submitSubmission({ 
                        title, 
                        category, 
                        content, 
                        anonymousRequest,
                        images: uploadedImages // 传递图片的base64数组
                    });
                    
                    if (result.success) {
                        document.getElementById('submissionForm').classList.add('hidden');
                        document.getElementById('submissionSuccess').classList.remove('hidden');
                        Utils.clearForm('submissionForm');
                        // 清空图片预览和存储
                        previewContainer.innerHTML = '';
                        uploadedImages = [];
                        this.loadUserSubmissions(); // 更新我的投稿列表
                        this.loadPendingSubmissions(); // 更新待审核列表
                        Utils.showNotification('发布成功，等待审核');
                    } else {
                        Utils.showNotification(result.message, true);
                    }
                });
                
                // 再发布一条按钮
                document.getElementById('submitAnotherBtn').addEventListener('click', () => {
                    document.getElementById('submissionSuccess').classList.add('hidden');
                    document.getElementById('submissionForm').classList.remove('hidden');
                    // 清空图片预览和存储
                    previewContainer.innerHTML = '';
                    uploadedImages = [];
                });
            },
            
            // 添加图片预览
            addImagePreview(container, imageData, index, removeCallback) {
                const preview = document.createElement('div');
                preview.className = 'image-preview';
                preview.innerHTML = `
                    <img src="${imageData}" alt="预览图">
                    <div class="remove-image" data-index="${index}">×</div>
                `;
                
                container.appendChild(preview);
                
                // 添加删除事件
                preview.querySelector('.remove-image').addEventListener('click', () => {
                    container.removeChild(preview);
                    if (removeCallback) {
                        removeCallback(index);
                    }
                });
            },
            
            // 阻止默认拖放行为
            preventsDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            },
            
            // 初始化事件监听
            initEventListeners() {
                // 导航链接点击事件
                document.querySelectorAll('a[href^="#"]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const anchorId = link.getAttribute('href').substring(1);
                        if (anchorId) {
                            Utils.scrollToAnchor(anchorId);
                        }
                    });
                });
                
                // 移动端菜单按钮
                document.getElementById('mobileMenuBtn').addEventListener('click', () => {
                    const mobileMenu = document.getElementById('mobileMenu');
                    mobileMenu.classList.toggle('hidden');
                });
                
                // 用户下拉菜单
                document.getElementById('userBtn').addEventListener('click', () => {
                    const dropdownMenu = document.getElementById('dropdownMenu');
                    dropdownMenu.classList.toggle('hidden');
                });
                
                // 点击其他地方关闭下拉菜单
                document.addEventListener('click', (e) => {
                    const userBtn = document.getElementById('userBtn');
                    const dropdownMenu = document.getElementById('dropdownMenu');
                    
                    if (!userBtn.contains(e.target) && !dropdownMenu.contains(e.target)) {
                        dropdownMenu.classList.add('hidden');
                    }
                });
                
                // 登录按钮
                document.getElementById('loginBtn').addEventListener('click', () => {
                    Utils.showModal('loginModal');
                });
                document.getElementById('mobileLoginBtn').addEventListener('click', () => {
                    Utils.showModal('loginModal');
                });
                document.getElementById('submitLoginBtn').addEventListener('click', () => {
                    Utils.showModal('loginModal');
                });
                document.getElementById('submissionsLoginBtn').addEventListener('click', () => {
                    Utils.showModal('loginModal');
                });
                document.getElementById('adminLoginBtn').addEventListener('click', () => {
                    Utils.showModal('loginModal');
                });
                document.getElementById('profileLoginBtn').addEventListener('click', () => {
                    Utils.showModal('loginModal');
                });
                
                // 注册按钮
                document.getElementById('registerBtn').addEventListener('click', () => {
                    Utils.showModal('registerModal');
                });
                document.getElementById('mobileRegisterBtn').addEventListener('click', () => {
                    Utils.showModal('registerModal');
                });
                
                // 关闭登录模态框
                document.getElementById('closeLoginModal').addEventListener('click', () => {
                    Utils.hideModal('loginModal');
                });
                
                // 关闭注册模态框
                document.getElementById('closeRegisterModal').addEventListener('click', () => {
                    Utils.hideModal('registerModal');
                });
                
                // 切换到注册
                document.getElementById('switchToRegister').addEventListener('click', (e) => {
                    e.preventDefault();
                    Utils.hideModal('loginModal');
                    setTimeout(() => {
                        Utils.showModal('registerModal');
                    }, 300);
                });
                
                // 切换到登录
                document.getElementById('switchToLogin').addEventListener('click', (e) => {
                    e.preventDefault();
                    Utils.hideModal('registerModal');
                    setTimeout(() => {
                        Utils.showModal('loginModal');
                    }, 300);
                });
                
                // 登录表单提交
                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const phone = document.getElementById('loginPhone').value;
                    const password = document.getElementById('loginPassword').value;
                    
                    const result = AppData.login(phone, password);
                    if (result.success) {
                        Utils.hideModal('loginModal');
                        Utils.clearForm('loginForm');
                        this.updatePageState();
                        Utils.showNotification('登录成功');
                    } else {
                        Utils.showNotification(result.message, true);
                    }
                });
                
                // 注册表单提交
                document.getElementById('registerForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const phone = document.getElementById('registerPhone').value;
                    const name = document.getElementById('registerName').value;
                    const password = document.getElementById('registerPassword').value;
                    const confirmPassword = document.getElementById('registerConfirmPassword').value;
                    
                    if (password !== confirmPassword) {
                        Utils.showNotification('两次输入的密码不一致', true);
                        return;
                    }
                    
                    const result = AppData.register({ phone, name, password });
                    if (result.success) {
                        Utils.hideModal('registerModal');
                        Utils.clearForm('registerForm');
                        this.updatePageState();
                        Utils.showNotification('注册成功');
                    } else {
                        Utils.showNotification(result.message, true);
                    }
                });
                
                // 登出按钮
                document.getElementById('logoutBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    AppData.logout();
                    this.updatePageState();
                    Utils.showNotification('已成功登出');
                });
                document.getElementById('mobileLogoutBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    AppData.logout();
                    this.updatePageState();
                    document.getElementById('mobileMenu').classList.add('hidden');
                    Utils.showNotification('已成功登出');
                });
                
                // 加载更多帖子
                document.getElementById('loadMoreBtn').addEventListener('click', () => {
                    // 这里只是模拟加载更多
                    Utils.showNotification('已加载全部内容');
                });
                
                // 板块切换按钮
                document.getElementById('allPostsBtn').addEventListener('click', () => {
                    this.switchForumTab('all');
                });
                document.getElementById('confessionBtn').addEventListener('click', () => {
                    this.switchForumTab('confession');
                });
                document.getElementById('complaintBtn').addEventListener('click', () => {
                    this.switchForumTab('complaint');
                });
                document.getElementById('questionBtn').addEventListener('click', () => {
                    this.switchForumTab('question');
                });
                
                // 审核标签切换
                document.getElementById('pendingReviewsBtn').addEventListener('click', () => {
                    this.switchReviewTab('pending');
                });
                document.getElementById('approvedBtn').addEventListener('click', () => {
                    this.switchReviewTab('approved');
                });
                document.getElementById('rejectedBtn').addEventListener('click', () => {
                    this.switchReviewTab('rejected');
                });
                
                // 关闭审核模态框
                document.getElementById('closeReviewModal').addEventListener('click', () => {
                    Utils.hideModal('reviewModal');
                });
                
                // 通过并发布按钮
                document.getElementById('approveSubmission').addEventListener('click', () => {
                    const submissionId = document.getElementById('reviewModal').dataset.submissionId;
                    const anonymous = document.getElementById('reviewAnonymous').checked;
                    const note = document.getElementById('reviewNote').value;
                    
                    const result = AppData.reviewSubmission(submissionId, true, anonymous, note);
                    if (result.success) {
                        Utils.hideModal('reviewModal');
                        this.loadPendingSubmissions();
                        this.loadApprovedSubmissions();
                        this.loadPosts();
                        this.loadUserSubmissions();
                        Utils.showNotification('已通过并发布');
                    } else {
                        Utils.showNotification(result.message, true);
                    }
                });
                
                // 拒绝按钮
                document.getElementById('rejectSubmission').addEventListener('click', () => {
                    const submissionId = document.getElementById('reviewModal').dataset.submissionId;
                    const note = document.getElementById('reviewNote').value;
                    
                    const result = AppData.reviewSubmission(submissionId, false, false, note);
                    if (result.success) {
                        Utils.hideModal('reviewModal');
                        this.loadPendingSubmissions();
                        this.loadRejectedSubmissions();
                        this.loadUserSubmissions();
                        Utils.showNotification('已拒绝该内容');
                    } else {
                        Utils.showNotification(result.message, true);
                    }
                });
                
                // 个人资料表单提交
                document.getElementById('profileForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const name = document.getElementById('profileName').value;
                    const bio = document.getElementById('profileBio').value;
                    
                    const result = AppData.updateProfile({ name, bio });
                    if (result.success) {
                        this.updateProfileView();
                        this.updateUserDisplay();
                        Utils.showNotification('资料更新成功');
                    } else {
                        Utils.showNotification(result.message, true);
                    }
                });
            },
            
            // 切换论坛板块
            switchForumTab(tab) {
                const allBtn = document.getElementById('allPostsBtn');
                const confessionBtn = document.getElementById('confessionBtn');
                const complaintBtn = document.getElementById('complaintBtn');
                const questionBtn = document.getElementById('questionBtn');
                
                // 重置所有按钮样式
                allBtn.className = 'px-6 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm flex items-center hover:border-primary hover:text-primary transition-colors';
                confessionBtn.className = 'px-6 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm flex items-center hover:border-confession hover:text-confession transition-colors';
                complaintBtn.className = 'px-6 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm flex items-center hover:border-complaint hover:text-complaint transition-colors';
                questionBtn.className = 'px-6 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm flex items-center hover:border-question hover:text-question transition-colors';
                
                // 设置选中按钮样式
                if (tab === 'all') {
                    allBtn.className = 'px-6 py-2 rounded-full bg-primary text-white text-sm flex items-center';
                } else if (tab === 'confession') {
                    confessionBtn.className = 'px-6 py-2 rounded-full bg-confession text-white text-sm flex items-center';
                } else if (tab === 'complaint') {
                    complaintBtn.className = 'px-6 py-2 rounded-full bg-complaint text-white text-sm flex items-center';
                } else if (tab === 'question') {
                    questionBtn.className = 'px-6 py-2 rounded-full bg-question text-white text-sm flex items-center';
                }
                
                // 加载对应板块的帖子
                this.loadPosts(tab);
            },
            
            // 更新页面状态
            updatePageState() {
                const currentUser = AppData.currentUser;
                
                // 更新用户显示
                this.updateUserDisplay();
                
                // 更新投稿区域
                this.updateSubmissionArea();
                
                // 更新我的投稿区域
                this.updateMySubmissionsArea();
                
                // 更新审核面板
                this.updateAdminPanel();
                
                // 更新个人资料区域
                this.updateProfileArea();
            },
            
            // 更新用户显示
            updateUserDisplay() {
                const currentUser = AppData.currentUser;
                const loginBtn = document.getElementById('loginBtn');
                const registerBtn = document.getElementById('registerBtn');
                const userDropdown = document.getElementById('userDropdown');
                const usernameDisplay = document.getElementById('usernameDisplay');
                const mobileLoginBtn = document.getElementById('mobileLoginBtn');
                const mobileRegisterBtn = document.getElementById('mobileRegisterBtn');
                const mobileUserMenu = document.getElementById('mobileUserMenu');
                const mobileUsername = document.getElementById('mobileUsername');
                const adminLink = document.getElementById('adminLink');
                const mobileAdminLink = document.getElementById('mobileAdminLink');
                
                if (currentUser) {
                    // 显示用户菜单
                    loginBtn.classList.add('hidden');
                    registerBtn.classList.add('hidden');
                    userDropdown.classList.remove('hidden');
                    usernameDisplay.textContent = currentUser.name;
                    
                    mobileLoginBtn.classList.add('hidden');
                    mobileRegisterBtn.classList.add('hidden');
                    mobileUserMenu.classList.remove('hidden');
                    mobileUsername.textContent = currentUser.name;
                    
                    // 显示管理员链接（如果是管理员）
                    if (currentUser.isAdmin) {
                        adminLink.classList.remove('hidden');
                        mobileAdminLink.classList.remove('hidden');
                    } else {
                        adminLink.classList.add('hidden');
                        mobileAdminLink.classList.add('hidden');
                    }
                } else {
                    // 显示登录/注册按钮
                    loginBtn.classList.remove('hidden');
                    registerBtn.classList.remove('hidden');
                    userDropdown.classList.add('hidden');
                    
                    mobileLoginBtn.classList.remove('hidden');
                    mobileRegisterBtn.classList.remove('hidden');
                    mobileUserMenu.classList.add('hidden');
                    
                    adminLink.classList.add('hidden');
                    mobileAdminLink.classList.add('hidden');
                }
            },
            
            // 更新投稿区域
            updateSubmissionArea() {
                const currentUser = AppData.currentUser;
                const loginPrompt = document.getElementById('loginPrompt');
                const submissionForm = document.getElementById('submissionForm');
                const submissionSuccess = document.getElementById('submissionSuccess');
                
                if (currentUser) {
                    loginPrompt.classList.add('hidden');
                    submissionForm.classList.remove('hidden');
                    submissionSuccess.classList.add('hidden');
                } else {
                    loginPrompt.classList.remove('hidden');
                    submissionForm.classList.add('hidden');
                    submissionSuccess.classList.add('hidden');
                }
            },
            
            // 更新我的投稿区域
            updateMySubmissionsArea() {
                const currentUser = AppData.currentUser;
                const submissionsLoginPrompt = document.getElementById('submissionsLoginPrompt');
                const mySubmissionsContainer = document.getElementById('mySubmissionsContainer');
                
                if (currentUser) {
                    submissionsLoginPrompt.classList.add('hidden');
                    mySubmissionsContainer.classList.remove('hidden');
                    this.loadUserSubmissions();
                } else {
                    submissionsLoginPrompt.classList.remove('hidden');
                    mySubmissionsContainer.classList.add('hidden');
                }
            },
            
            // 加载用户投稿
            loadUserSubmissions() {
                const currentUser = AppData.currentUser;
                if (!currentUser) return;
                
                const submissions = AppData.getUserSubmissions(currentUser.id);
                const mySubmissionsContainer = document.getElementById('mySubmissionsContainer');
                const noSubmissions = document.getElementById('noSubmissions');
                
                // 清空容器
                while (mySubmissionsContainer.firstChild) {
                    if (mySubmissionsContainer.firstChild.id !== 'noSubmissions') {
                        mySubmissionsContainer.removeChild(mySubmissionsContainer.firstChild);
                    } else {
                        break;
                    }
                }
                
                if (submissions.length === 0) {
                    noSubmissions.classList.remove('hidden');
                    return;
                }
                
                noSubmissions.classList.add('hidden');
                
                // 添加投稿
                submissions.forEach(submission => {
                    let statusBadge = '';
                    if (submission.status === AppData.submissionStatus.PENDING) {
                        statusBadge = '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">待审核</span>';
                    } else if (submission.status === AppData.submissionStatus.APPROVED) {
                        statusBadge = '<span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">已通过</span>';
                    } else {
                        statusBadge = '<span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">已拒绝</span>';
                    }
                    
                    // 处理图片预览
                    let imagesHtml = '';
                    if (submission.images && submission.images.length > 0) {
                        imagesHtml = '<div class="image-preview-container my-4">';
                        submission.images.slice(0, 3).forEach(img => {
                            imagesHtml += `<div class="image-preview"><img src="${img}" alt="发布图片"></div>`;
                        });
                        if (submission.images.length > 3) {
                            imagesHtml += `<div class="image-preview bg-gray-100 flex items-center justify-center text-gray-500">
                                +${submission.images.length - 3}
                            </div>`;
                        }
                        imagesHtml += '</div>';
                    }
                    
                    const categoryColor = AppData.getCategoryColor(submission.category);
                    const categoryName = AppData.getCategoryName(submission.category);
                    
                    const submissionElement = document.createElement('div');
                    submissionElement.className = 'bg-white rounded-xl shadow-sm p-6 card-hover';
                    submissionElement.innerHTML = `
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-lg font-semibold hover:text-primary transition-colors">${submission.title}</h3>
                            ${statusBadge}
                        </div>
                        <p class="text-neutral text-sm mb-4 line-clamp-2">${submission.content}</p>
                        ${imagesHtml}
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="bg-${categoryColor}/10 text-${categoryColor} text-xs px-2 py-1 rounded-full">${categoryName}</span>
                            ${submission.anonymousRequest ? '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">已申请匿名</span>' : ''}
                            ${submission.anonymous ? '<span class="bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full">已匿名发布</span>' : ''}
                        </div>
                        <div class="flex justify-between items-center text-sm text-gray-500">
                            <span>发布时间: ${Utils.formatDate(submission.submitTime)}</span>
                            ${submission.reviewTime ? `<span>审核时间: ${Utils.formatDate(submission.reviewTime)}</span>` : ''}
                        </div>
                        ${submission.reviewNote ? `
                            <div class="mt-4 pt-4 border-t border-gray-100">
                                <p class="text-sm"><span class="font-medium">审核备注:</span> ${submission.reviewNote}</p>
                            </div>
                        ` : ''}
                    `;
                    
                    mySubmissionsContainer.insertBefore(submissionElement, noSubmissions);
                });
            },
            
            // 更新审核面板
            updateAdminPanel() {
                const currentUser = AppData.currentUser;
                const adminLoginPrompt = document.getElementById('adminLoginPrompt');
                const adminPanelContainer = document.getElementById('adminPanelContainer');
                
                if (currentUser && currentUser.isAdmin) {
                    adminLoginPrompt.classList.add('hidden');
                    adminPanelContainer.classList.remove('hidden');
                    this.loadPendingSubmissions();
                    this.loadApprovedSubmissions();
                    this.loadRejectedSubmissions();
                } else {
                    adminLoginPrompt.classList.remove('hidden');
                    adminPanelContainer.classList.add('hidden');
                }
            },
            
            // 切换审核标签
            switchReviewTab(tab) {
                const pendingBtn = document.getElementById('pendingReviewsBtn');
                const approvedBtn = document.getElementById('approvedBtn');
                const rejectedBtn = document.getElementById('rejectedBtn');
                const pendingSubmissions = document.getElementById('pendingSubmissions');
                const approvedSubmissions = document.getElementById('approvedSubmissions');
                const rejectedSubmissions = document.getElementById('rejectedSubmissions');
                
                // 重置所有按钮样式
                pendingBtn.className = 'px-4 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm hover:border-primary hover:text-primary transition-colors';
                approvedBtn.className = 'px-4 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm hover:border-primary hover:text-primary transition-colors';
                rejectedBtn.className = 'px-4 py-2 rounded-full bg-white text-dark border border-gray-200 text-sm hover:border-primary hover:text-primary transition-colors';
                
                // 隐藏所有内容
                pendingSubmissions.classList.add('hidden');
                approvedSubmissions.classList.add('hidden');
                rejectedSubmissions.classList.add('hidden');
                
                // 显示选中的标签
                if (tab === 'pending') {
                    pendingBtn.className = 'px-4 py-2 rounded-full bg-primary text-white text-sm';
                    pendingSubmissions.classList.remove('hidden');
                } else if (tab === 'approved') {
                    approvedBtn.className = 'px-4 py-2 rounded-full bg-primary text-white text-sm';
                    approvedSubmissions.classList.remove('hidden');
                } else if (tab === 'rejected') {
                    rejectedBtn.className = 'px-4 py-2 rounded-full bg-primary text-white text-sm';
                    rejectedSubmissions.classList.remove('hidden');
                }
            },
            
            // 加载待审核投稿
            loadPendingSubmissions() {
                const submissions = AppData.getPendingSubmissions();
                const pendingSubmissions = document.getElementById('pendingSubmissions');
                const noPendingSubmissions = document.getElementById('noPendingSubmissions');
                
                // 清空容器
                while (pendingSubmissions.firstChild) {
                    if (pendingSubmissions.firstChild.id !== 'noPendingSubmissions') {
                        pendingSubmissions.removeChild(pendingSubmissions.firstChild);
                    } else {
                        break;
                    }
                }
                
                if (submissions.length === 0) {
                    noPendingSubmissions.classList.remove('hidden');
                    return;
                }
                
                noPendingSubmissions.classList.add('hidden');
                
                // 添加投稿
                submissions.forEach(submission => {
                    // 处理图片预览
                    let imagesHtml = '';
                    if (submission.images && submission.images.length > 0) {
                        imagesHtml = '<div class="image-preview-container my-4">';
                        submission.images.slice(0, 3).forEach(img => {
                            imagesHtml += `<div class="image-preview"><img src="${img}" alt="发布图片"></div>`;
                        });
                        if (submission.images.length > 3) {
                            imagesHtml += `<div class="image-preview bg-gray-100 flex items-center justify-center text-gray-500">
                                +${submission.images.length - 3}
                            </div>`;
                        }
                        imagesHtml += '</div>';
                    }
                    
                    const categoryColor = AppData.getCategoryColor(submission.category);
                    const categoryName = AppData.getCategoryName(submission.category);
                    
                    const submissionElement = document.createElement('div');
                    submissionElement.className = 'bg-white rounded-xl shadow-sm p-6 card-hover';
                    submissionElement.innerHTML = `
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-lg font-semibold">${submission.title}</h3>
                            <span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">待审核</span>
                        </div>
                        <p class="text-neutral text-sm mb-4 line-clamp-2">${submission.content}</p>
                        ${imagesHtml}
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="bg-${categoryColor}/10 text-${categoryColor} text-xs px-2 py-1 rounded-full">${categoryName}</span>
                            ${submission.anonymousRequest ? '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">已申请匿名</span>' : ''}
                        </div>
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-sm text-gray-500">发布人: ${submission.authorName}</p>
                                <p class="text-sm text-gray-500">手机号: ${Utils.formatPhone(submission.authorPhone)}</p>
                                <p class="text-sm text-gray-500">发布时间: ${Utils.formatDate(submission.submitTime)}</p>
                            </div>
                            <button class="review-btn btn-secondary text-sm" data-id="${submission.id}">
                                审核
                            </button>
                        </div>
                    `;
                    
                    pendingSubmissions.insertBefore(submissionElement, noPendingSubmissions);
                    
                    // 添加审核按钮事件
                    submissionElement.querySelector('.review-btn').addEventListener('click', () => {
                        this.openReviewModal(submission);
                    });
                });
            },
            
            // 加载已通过投稿
            loadApprovedSubmissions() {
                const submissions = AppData.getApprovedSubmissions();
                const approvedSubmissions = document.getElementById('approvedSubmissions');
                
                // 清空容器
                approvedSubmissions.innerHTML = '';
                
                if (submissions.length === 0) {
                    approvedSubmissions.innerHTML = `
                        <div class="py-20 text-center">
                            <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fa fa-check-circle text-3xl text-gray-400"></i>
                            </div>
                            <h3 class="text-xl font-medium mb-2">暂无已通过内容</h3>
                            <p class="text-neutral">还没有通过审核的内容</p>
                        </div>
                    `;
                    return;
                }
                
                // 添加投稿
                submissions.forEach(submission => {
                    // 处理图片预览
                    let imagesHtml = '';
                    if (submission.images && submission.images.length > 0) {
                        imagesHtml = '<div class="image-preview-container my-4">';
                        submission.images.slice(0, 3).forEach(img => {
                            imagesHtml += `<div class="image-preview"><img src="${img}" alt="发布图片"></div>`;
                        });
                        if (submission.images.length > 3) {
                            imagesHtml += `<div class="image-preview bg-gray-100 flex items-center justify-center text-gray-500">
                                +${submission.images.length - 3}
                            </div>`;
                        }
                        imagesHtml += '</div>';
                    }
                    
                    const categoryColor = AppData.getCategoryColor(submission.category);
                    const categoryName = AppData.getCategoryName(submission.category);
                    
                    const submissionElement = document.createElement('div');
                    submissionElement.className = 'bg-white rounded-xl shadow-sm p-6 card-hover';
                    submissionElement.innerHTML = `
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-lg font-semibold">${submission.title}</h3>
                            <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">已通过</span>
                        </div>
                        <p class="text-neutral text-sm mb-4 line-clamp-2">${submission.content}</p>
                        ${imagesHtml}
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="bg-${categoryColor}/10 text-${categoryColor} text-xs px-2 py-1 rounded-full">${categoryName}</span>
                            ${submission.anonymous ? '<span class="bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full">已匿名发布</span>' : ''}
                        </div>
                        <div class="flex justify-between items-center text-sm text-gray-500">
                            <div>
                                <p>发布人: ${submission.authorName}</p>
                                <p>手机号: ${Utils.formatPhone(submission.authorPhone)}</p>
                                <p>发布时间: ${Utils.formatDate(submission.submitTime)}</p>
                            </div>
                            <p>审核时间: ${Utils.formatDate(submission.reviewTime)}</p>
                        </div>
                    `;
                    
                    approvedSubmissions.appendChild(submissionElement);
                });
            },
            
            // 加载已拒绝投稿
            loadRejectedSubmissions() {
                const submissions = AppData.getRejectedSubmissions();
                const rejectedSubmissions = document.getElementById('rejectedSubmissions');
                
                // 清空容器
                rejectedSubmissions.innerHTML = '';
                
                if (submissions.length === 0) {
                    rejectedSubmissions.innerHTML = `
                        <div class="py-20 text-center">
                            <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fa fa-times-circle text-3xl text-gray-400"></i>
                            </div>
                            <h3 class="text-xl font-medium mb-2">暂无已拒绝内容</h3>
                            <p class="text-neutral">还没有被拒绝的内容</p>
                        </div>
                    `;
                    return;
                }
                
                // 添加投稿
                submissions.forEach(submission => {
                    // 处理图片预览
                    let imagesHtml = '';
                    if (submission.images && submission.images.length > 0) {
                        imagesHtml = '<div class="image-preview-container my-4">';
                        submission.images.slice(0, 3).forEach(img => {
                            imagesHtml += `<div class="image-preview"><img src="${img}" alt="发布图片"></div>`;
                        });
                        if (submission.images.length > 3) {
                            imagesHtml += `<div class="image-preview bg-gray-100 flex items-center justify-center text-gray-500">
                                +${submission.images.length - 3}
                            </div>`;
                        }
                        imagesHtml += '</div>';
                    }
                    
                    const categoryColor = AppData.getCategoryColor(submission.category);
                    const categoryName = AppData.getCategoryName(submission.category);
                    
                    const submissionElement = document.createElement('div');
                    submissionElement.className = 'bg-white rounded-xl shadow-sm p-6 card-hover';
                    submissionElement.innerHTML = `
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-lg font-semibold">${submission.title}</h3>
                            <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">已拒绝</span>
                        </div>
                        <p class="text-neutral text-sm mb-4 line-clamp-2">${submission.content}</p>
                        ${imagesHtml}
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="bg-${categoryColor}/10 text-${categoryColor} text-xs px-2 py-1 rounded-full">${categoryName}</span>
                        </div>
                        <div class="mb-4">
                            <p class="text-sm"><span class="font-medium">拒绝原因:</span> ${submission.reviewNote || '未提供原因'}</p>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gray-500">
                            <div>
                                <p>发布人: ${submission.authorName}</p>
                                <p>手机号: ${Utils.formatPhone(submission.authorPhone)}</p>
                                <p>发布时间: ${Utils.formatDate(submission.submitTime)}</p>
                            </div>
                            <p>审核时间: ${Utils.formatDate(submission.reviewTime)}</p>
                        </div>
                    `;
                    
                    rejectedSubmissions.appendChild(submissionElement);
                });
            },
            
            // 打开审核模态框
            openReviewModal(submission) {
                const reviewModal = document.getElementById('reviewModal');
                const reviewTitle = document.getElementById('reviewTitle');
                const reviewCategory = document.getElementById('reviewCategory');
                const reviewBody = document.getElementById('reviewBody');
                const reviewImages = document.getElementById('reviewImages');
                const reviewAuthor = document.getElementById('reviewAuthor');
                const reviewAuthorPhone = document.getElementById('reviewAuthorPhone');
                const reviewTime = document.getElementById('reviewTime');
                const reviewAnonymous = document.getElementById('reviewAnonymous');
                const reviewNote = document.getElementById('reviewNote');
                
                // 清空图片预览
                reviewImages.innerHTML = '';
                
                // 设置图片预览
                if (submission.images && submission.images.length > 0) {
                    submission.images.forEach(img => {
                        const imgElement = document.createElement('div');
                        imgElement.className = 'image-preview';
                        imgElement.innerHTML = `<img src="${img}" alt="发布图片">`;
                        reviewImages.appendChild(imgElement);
                    });
                }
                
                // 设置模态框数据
                reviewModal.dataset.submissionId = submission.id;
                reviewTitle.textContent = submission.title;
                
                const categoryColor = AppData.getCategoryColor(submission.category);
                const categoryName = AppData.getCategoryName(submission.category);
                reviewCategory.innerHTML = `<span class="section-indicator bg-${categoryColor}"></span>${categoryName}`;
                
                reviewBody.textContent = submission.content;
                reviewAuthor.textContent = submission.authorName;
                reviewAuthorPhone.textContent = submission.authorPhone; // 管理员可以看到完整手机号
                reviewTime.textContent = Utils.formatDate(submission.submitTime);
                reviewAnonymous.checked = submission.anonymousRequest;
                reviewNote.value = '';
                
                // 显示模态框
                Utils.showModal('reviewModal');
            },
            
            // 更新个人资料区域
            updateProfileArea() {
                const currentUser = AppData.currentUser;
                const profileLoginPrompt = document.getElementById('profileLoginPrompt');
                const profileContainer = document.getElementById('profileContainer');
                
                if (currentUser) {
                    profileLoginPrompt.classList.add('hidden');
                    profileContainer.classList.remove('hidden');
                    this.updateProfileView();
                } else {
                    profileLoginPrompt.classList.remove('hidden');
                    profileContainer.classList.add('hidden');
                }
            },
            
            // 更新个人资料视图
            updateProfileView() {
                const currentUser = AppData.currentUser;
                if (!currentUser) return;
                
                document.getElementById('profileAvatar').src = currentUser.avatar;
                document.getElementById('profileUsername').textContent = currentUser.name;
                document.getElementById('profileJoinDate').textContent = `加入时间: ${currentUser.joinDate}`;
                document.getElementById('profilePhone').value = currentUser.phone;
                
                // 显示管理员身份
                const profileRole = document.getElementById('profileRole');
                if (currentUser.isAdmin) {
                    profileRole.textContent = '身份: 管理员';
                    profileRole.className = 'text-sm mt-2 text-primary font-medium';
                    profileRole.classList.remove('hidden');
                } else {
                    profileRole.classList.add('hidden');
                }
                
                document.getElementById('profileName').value = currentUser.name;
                document.getElementById('profileBio').value = currentUser.bio || '';
            },
            
            // 加载帖子
            loadPosts(categoryFilter = 'all') {
                let approvedSubmissions = AppData.getApprovedSubmissions();
                
                // 根据板块筛选
                if (categoryFilter !== 'all' && ['confession', 'complaint', 'question'].includes(categoryFilter)) {
                    approvedSubmissions = approvedSubmissions.filter(s => s.category === categoryFilter);
                }
                
                const postsContainer = document.getElementById('postsContainer');
                const loadingPosts = document.getElementById('loadingPosts');
                const noPosts = document.getElementById('noPosts');
                
                // 清空容器
                while (postsContainer.firstChild) {
                    if (postsContainer.firstChild.id !== 'loadingPosts' && postsContainer.firstChild.id !== 'noPosts') {
                        postsContainer.removeChild(postsContainer.firstChild);
                    } else {
                        break;
                    }
                }
                
                // 隐藏加载状态，显示内容
                loadingPosts.classList.add('hidden');
                
                if (approvedSubmissions.length === 0) {
                    noPosts.classList.remove('hidden');
                    return;
                }
                
                noPosts.classList.add('hidden');
                
                // 添加帖子
                approvedSubmissions.forEach(submission => {
                    // 处理图片预览
                    let imagesHtml = '';
                    if (submission.images && submission.images.length > 0) {
                        imagesHtml = '<div class="grid grid-cols-2 md:grid-cols-4 gap-3 my-4">';
                        submission.images.forEach(img => {
                            imagesHtml += `<div class="aspect-video bg-gray-100 rounded-md overflow-hidden">
                                <img src="${img}" alt="发布图片" class="w-full h-full object-cover hover:scale-105 transition-transform duration-300">
                            </div>`;
                        });
                        imagesHtml += '</div>';
                    }
                    
                    const categoryColor = AppData.getCategoryColor(submission.category);
                    const categoryName = AppData.getCategoryName(submission.category);
                    
                    const postElement = document.createElement('div');
                    postElement.className = 'bg-white rounded-xl shadow-sm p-6 md:p-8 card-hover';
                    postElement.innerHTML = `
                        <div class="flex items-center mb-6">
                            <img src="${submission.anonymous ? 'https://picsum.photos/id/1000/50/50' : AppData.users.find(u => u.id === submission.authorId)?.avatar}" alt="${submission.anonymous ? '匿名用户' : submission.authorName}" class="w-12 h-12 rounded-full object-cover mr-4">
                            <div>
                                <h4 class="font-medium">${submission.anonymous ? '匿名用户' : submission.authorName}</h4>
                                <p class="text-sm text-gray-500">${Utils.formatDate(submission.submitTime)}</p>
                            </div>
                            <span class="ml-auto bg-${categoryColor}/10 text-${categoryColor} text-xs px-3 py-1 rounded-full">${categoryName}</span>
                        </div>
                        <h3 class="text-xl font-bold mb-4 hover:text-primary transition-colors">${submission.title}</h3>
                        <p class="text-neutral mb-6">${submission.content}</p>
                        ${imagesHtml}
                        <div class="flex items-center justify-between pt-4 border-t border-gray-100">
                            <div class="flex items-center space-x-6">
                                <button class="flex items-center text-gray-500 hover:text-primary transition-colors">
                                    <i class="fa fa-thumbs-up mr-2"></i>
                                    <span>赞同</span>
                                </button>
                                <button class="flex items-center text-gray-500 hover:text-primary transition-colors">
                                    <i class="fa fa-comment mr-2"></i>
                                    <span>评论</span>
                                </button>
                            </div>
                            <button class="flex items-center text-gray-500 hover:text-primary transition-colors">
                                <i class="fa fa-share-alt mr-2"></i>
                                <span>分享</span>
                            </button>
                        </div>
                    `;
                    
                    postsContainer.insertBefore(postElement, noPosts);
                });
            }
        };

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            ViewController.init();
        });
    </script>
</body>
</html>
